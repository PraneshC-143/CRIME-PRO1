# Historical Data Integration Quick Reference

## Overview
This guide provides quick instructions for integrating historical crime data (1969-2016) into the CrimeScope dashboard.

## Prerequisites
1. Python 3.8 or higher installed
2. All dependencies installed: `pip install -r requirements.txt`
3. CrimeDataset repository downloaded from: https://github.com/avinashladdha/CrimeDataset

## Quick Start (3 Steps)

### Step 1: Download CrimeDataset
```bash
# Option A: Clone the repository
git clone https://github.com/avinashladdha/CrimeDataset.git

# Option B: Download ZIP
# Visit https://github.com/avinashladdha/CrimeDataset and download ZIP
# Extract to a known location (e.g., ~/Downloads/CrimeDataset)
```

### Step 2: Run the Integration Script
```bash
# Using the helper script (recommended)
./scripts/fetch_and_integrate.sh /path/to/CrimeDataset

# OR using Python directly
python scripts/fetch_historical_data.py --local-path /path/to/CrimeDataset
```

### Step 3: Launch the Dashboard
```bash
streamlit run streamlit_app.py
```

The dashboard will automatically load the combined dataset (1969-2023).

## What Happens During Integration?

1. **Reads year folders** from CrimeDataset (1969.0 through 2016.0)
2. **Processes CSV files** in each folder
3. **Standardizes column names** to match current schema
4. **Fills missing columns** with 0 values
5. **Merges historical + current** data
6. **Saves as CSV**: `historical-crime-data-complete.csv`

## Verification

After running the integration, verify success:

1. Check file exists:
   ```bash
   ls -lh historical-crime-data-complete.csv
   ```

2. Run test suite:
   ```bash
   python scripts/test_integration.py
   ```

3. Check in dashboard:
   - Year slider should show 1969-2023
   - Info message should appear: "ðŸ“Š Loaded historical data: 1969-2023"

## Advanced Usage

### Custom Year Range
Process only specific years:
```bash
python scripts/fetch_historical_data.py \
  --local-path /path/to/CrimeDataset \
  --start-year 1990 \
  --end-year 2016
```

### Custom Output Location
Save to a different file:
```bash
python scripts/fetch_historical_data.py \
  --local-path /path/to/CrimeDataset \
  --output my-historical-data.csv
```

### Don't Merge with Current Data
Keep historical data separate:
```bash
python scripts/fetch_historical_data.py \
  --local-path /path/to/CrimeDataset \
  --no-merge
```

## Troubleshooting

### Issue: "Year folder not found"
**Solution**: Verify CrimeDataset has folders named `1969.0`, `1970.0`, etc.

### Issue: "No CSV files found"
**Solution**: Check that year folders contain CSV files with district data.

### Issue: "Historical data not loading in dashboard"
**Solutions**:
1. Verify `historical-crime-data-complete.csv` exists in root directory
2. Check `config.py`: `HISTORICAL_DATA_ENABLED = True`
3. Clear Streamlit cache: `streamlit cache clear`
4. Restart the Streamlit app

### Issue: Performance is slow
**Solutions**:
1. CSV format is faster than Excel (already using CSV)
2. Caching is enabled (already configured)
3. Filter by smaller year ranges in the UI
4. Consider processing subset of years if full range not needed

## Configuration Options

Edit `config.py` to customize:

```python
# Enable/disable historical data
HISTORICAL_DATA_ENABLED = True

# Filename for combined data
HISTORICAL_DATA_FILE = "historical-crime-data-complete.csv"

# Year range supported
MIN_YEAR = 1969
MAX_YEAR = 2023
```

## Data Schema

### Required Columns
- `state_name`: State name
- `district_name`: District name  
- `year`: Year (integer)

### Crime Columns
117 IPC crime types including:
- Violent crimes: murder, rape, kidnapping, robbery
- Property crimes: theft, burglary, dacoity
- Women-related: dowry deaths, assault on women, stalking
- Public order: rioting, arson, criminal trespass
- Economic: fraud, cheating, forgery
- And many more...

Missing columns are automatically filled with 0.

## File Structure

```
IPC-State-wise-Crime-Analysis-V2/
â”œâ”€â”€ streamlit_app.py              # Main app (no changes needed)
â”œâ”€â”€ data_loader.py                # Updated to load historical data
â”œâ”€â”€ config.py                     # Configuration with historical settings
â”œâ”€â”€ districtwise-ipc-crimes.xlsx  # Current data (2017-2022)
â”œâ”€â”€ historical-crime-data-complete.csv  # Generated by script
â””â”€â”€ scripts/
    â”œâ”€â”€ fetch_historical_data.py  # Main fetcher script
    â”œâ”€â”€ fetch_and_integrate.sh    # Helper bash script
    â””â”€â”€ test_integration.py       # Test suite
```

## Testing

Run comprehensive tests:
```bash
python scripts/test_integration.py
```

Tests include:
1. Configuration validation
2. Data loader functions
3. Schema standardization
4. Fetcher script validation
5. Backward compatibility
6. Sample integration

All tests should pass (6/6 âœ…).

## Attribution

Historical data source:
- **Repository**: [CrimeDataset by avinashladdha](https://github.com/avinashladdha/CrimeDataset)
- **Data Source**: Government of India Open Data
- **Coverage**: 1969-2016 (48 years)

Current data:
- **File**: districtwise-ipc-crimes.xlsx
- **Coverage**: 2017-2022 (6 years)

**Combined Coverage**: 1969-2023 (54 years)

## Support

For issues or questions:
1. Check the [main README](../README.md)
2. Review troubleshooting section above
3. Verify all dependencies are installed
4. Check Python version (3.8+)

## Next Steps

After integration:
1. âœ… Explore long-term trends (54 years)
2. âœ… Train ML models on extended dataset
3. âœ… Compare crime patterns across decades
4. âœ… Generate more accurate predictions
5. âœ… Analyze historical crime evolution
